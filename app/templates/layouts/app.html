<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smart Service Compliance Assistant</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: linear-gradient(to bottom right, #f0f4ff, #ffffff);
        background-attachment: fixed; /* Agar background tetap saat di-scroll */
        min-height: 100vh;
        margin: 0;
      }
      #app {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .toast.show {
        animation: toastFadeIn 0.4s ease-out;
      }
      @keyframes toastFadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <nav class="navbar navbar-expand-md navbar-light bg-white shadow-sm">
        <div class="container">
          <!-- Brand / Logo -->
          <a
            class="navbar-brand d-flex align-items-center"
            href="{{ url_for('auth_web.login') }}"
          >
            <img
              src="{{ url_for('static', filename='images/ic_logo.svg') }}"
              alt="Logo"
              style="width: 30px; height: auto"
            />
            <span class="vr mx-3"></span>
            <span class="navbar-brand-text fw-semibold"
              >Smart Service Compliance Assistant</span
            >
          </a>

          <!-- Hamburger -->
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarContent"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- Navbar links -->
          <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav me-auto">
              {% if current_user.is_authenticated %} {% set role_name =
              current_user.role.role_name %}

              <li class="nav-item">
                {% if role_name == 'Customer Service' %}
                <a
                  class="nav-link {{ 'active' if request.path == '/cs/dashboard' }}"
                  href="{{ url_for('cs.dashboard') }}"
                  >Dashboard</a
                >
                {% elif role_name == 'Supervisor' %}
                <a
                  class="nav-link {{ 'active' if request.path == '/spv/dashboard' }}"
                  href="{{ url_for('spv.dashboard') }}"
                  >Dashboard</a
                >
                {% endif %}
              </li>

              {% if role_name == 'Customer Service' %}
              <li class="nav-item">
                <a
                  class="nav-link {{ 'active' if request.endpoint == 'cs.service_guidelines' }}"
                  href="{{ url_for('cs.service_guidelines') }}"
                >
                  Service Guidelines
                </a>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link {{ 'active' if request.endpoint == 'cs.my_history' }}"
                  href="{{ url_for('cs.my_history') }}"
                >
                  My History
                </a>
              </li>
              {% elif role_name == 'Supervisor' %}
              <li class="nav-item">
                <a class="nav-link" href="/spv/user-management"
                  >User Management</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/spv/performance-analytics"
                  >Performance Analytics</a
                >
              </li>
              {% endif %} {% endif %}
            </ul>

            <ul class="navbar-nav ms-auto">
              {% if current_user.is_authenticated %}
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle fw-bold"
                  href="#"
                  role="button"
                  data-bs-toggle="dropdown"
                >
                  {{ current_user.name }}
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a
                      class="dropdown-item text-danger text-center fw-bold"
                      href="{{ url_for('auth_web.logout') }}"
                      onclick="event.preventDefault(); document.getElementById('logout-form').submit();"
                    >
                      <i class="bi bi-box-arrow-right me-1"></i> Logout
                    </a>
                    <form
                      id="logout-form"
                      action="{{ url_for('auth_web.logout') }}"
                      method="POST"
                      class="d-none"
                    >
                      <input
                        type="hidden"
                        name="csrf_token"
                        value="{{ csrf_token() }}"
                      />
                    </form>
                  </li>
                </ul>
              </li>
              {% else %}
              <li class="nav-item">
                <a class="nav-link" href="{{ url_for('auth_web.login') }}"
                  >Login</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="{{ url_for('auth_web.request_access') }}"
                  >Request Access</a
                >
              </li>
              {% endif %}
            </ul>
          </div>
        </div>
      </nav>

      <main class="py-4 container">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %}
        <div
          class="toast-container position-fixed top-0 start-50 translate-middle-x p-3"
          style="z-index: 2000; margin-top: 50px"
        >
          {% for category, msg in messages %}
          <div
            class="toast hide"
            role="alert"
            aria-live="assertive"
            aria-atomic="true"
            style="border-radius:8px; width:320px; background: {{ 'green' if category=='success' else 'red' }};"
          >
            <div class="toast-body text-center text-white">{{ msg }}</div>
          </div>
          {% endfor %}
        </div>
        {% endif %} {% endwith %} {% block content %}{% endblock %}
      </main>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  </body>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var toastElList = [].slice.call(document.querySelectorAll(".toast"));
      var toastList = toastElList.map(function (toastEl) {
        // delay: 3000 artinya 3 detik
        var t = new bootstrap.Toast(toastEl, { delay: 3000 });
        t.show();
        return t;
      });
    });
  </script>
</html>
